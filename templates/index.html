<!DOCTYPE html>
<html>
<head>
    <title>ALP</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href='../static/styles/style.css'>
</head>
<body>
    <div class="hero">
        <div class="chat-container">
            <div class="chat-box">
                <div class="response-container">
                    <div id="response"></div>
                    <div class="spinner" id="processing" style="display: none;">
                        <div class="cube1"></div>
                        <div class="cube2"></div>
                    </div>
                </div>
            </div>
            <div class="input-container">
                <form id="ask-form">
                    <!-- <label for="question">User Input:</label> -->
                    <textarea name="question" required style="width: 66%;"></textarea> <!-- Add inline style width: 66%; -->
                    <div class="button-container">
                        <input type="submit" value="Ask">
                        <input type="button" value="Export" onclick="window.location.href='/export_interactions'">
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="../static/scripts/chat.js"></script>
    <script>
        function renderChatHistory(chatHistory) {
            const responseDiv = document.getElementById("response");
            
            chatHistory.forEach((interaction) => {
                const role = interaction.interaction_type === "user" ? "User" : "Agent";
                responseDiv.innerHTML += `<p><strong>${role}:</strong> ${interaction.text}</p>`;
            });
        
            // If chat history is empty, display the agent's message
            if (chatHistory.length === 0) {
                responseDiv.innerHTML += '<p><strong>Agent:</strong> Hi! What can I do for you?</p>';
            }
            }

        let chatHistory = {{ chat_history|tojson|safe }};
        let sessionName = {{ session_name|tojson|safe }};
        console.log(chatHistory);
        console.log(sessionName);

        // Call the function to render chat history
        renderChatHistory(chatHistory);
    </script>
</body>
</html>
